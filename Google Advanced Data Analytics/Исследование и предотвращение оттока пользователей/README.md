# **Waze**
<a target="_blank" href="https://colab.research.google.com/github/VsevolodMus/Coursera/blob/main/Google%20Advanced%20Data%20Analytics/%D0%98%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%B8%20%D0%BF%D1%80%D0%B5%D0%B4%D0%BE%D1%82%D0%B2%D1%80%D0%B0%D1%89%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BE%D1%82%D1%82%D0%BE%D0%BA%D0%B0%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B9/Waze.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>

### О компании

Waze — бесплатное приложение для мобильных устройств, позволяющее отслеживать дорожную обстановку в реальном времени, создавать оптимальные маршруты и обмениваться информацией о дорожных условиях с другими пользователями. Карты создаются сообществом.

## Метаданные

| Имя колонки              | Тип   | Описание                                                                                                                                |
|--------------------------|-------|-----------------------------------------------------------------------------------------------------------------------------------------|
| ID                       | int   | Порядковый нумерованный индекс                                                                                                          |
| label                    | obj   | Колонка с бинарной целевой переменной содержит информацию о том, остался ли пользователь (retained) или ушел (churned) в течение месяца |
| sessions                 | int   | Количество случаев, когда пользователь открывал приложение в течение месяца                                                             |
| drives                   | int   | Случаи проезда не менее 1 км в течение месяца                                                                                           |
| device                   | obj   | Тип устройства, с которого пользователь начинает сеанс                                                                                  |
| total_sessions           | float | Общеее количество сеансов с момента регистрации пользователя                                                                            |
| n_days_after_onboarding  | int   | Количество дней с момента регистрации пользователя в приложении                                                                         |
| total_navigations_fav1   | int   | Общее количество поездок с момента регистрации пользователя в любимое место 1                                                           |
| total_navigations_fav2   | int   | Общее количество поездок с момента регистрации пользователя в любимое место 2                                                           |
| driven_km_drives         | float | Общий километраж, пройденный за месяц                                                                                                   |
| duration_minutes_drives  | float | Общая продолжительность поездки в минутах в течение месяца                                                                              |
| activity_days            | int   | Количество дней, когда пользователь открывает приложение в течение месяца                                                               |
| driving_days             | int   | Количество дней, в течение которых пользователь проезжает (не менее 1 км) в течение месяца.                                             |

**14 999 строк** - каждая строка представляет одного уникального пользователя 

**13 колонок**

### Цель проекта

Разработать модель машинного обучения для прогнозирования оттока пользователей. Отток измеряет количество пользователей, которые удалили приложение Waze или прекратили его использование.

### Инструменты
- `numpy`
- `pandas`
- `matplotlib`
- `seaborn`
- `xgboost`
- `sklearn.linear_model`
- `sklearn.tree`
- `sklearn.ensemble`
- `sklearn.model_selection`
- `sklearn.metrics`

## Результаты
### Краткое изложение результатов модели

Разработаны две модели машинного обучения - случайный лес и XGBoost, для предсказания оттока пользователей. Данные были разделены на обучающий, проверочный и тестовый наборы. Это трехкратное разбиение позволяет проводить отбор моделей на проверочном наборе, обеспечивая более точную оценку производительности на тестовых данных.

Модели выявили необходимость дополнительных данных для более точного прогнозирования оттока. Рекомендуется включить информацию о поездках (время в пути, географические данные) и более детализированные сведения о взаимодействии пользователей с приложением (сообщения о проблемах на дороге, подтверждения предупреждений). Также предложено учесть ежемесячное количество уникальных мест начала и завершения каждого маршрута.

### Заключение

<p align="center">
 <img width="767" height="455" src="https://github.com/VsevolodMus/Coursera/assets/138299372/e2b5341b-426b-4685-bb81-06e8a1a86d4c">
</p>


1. Созданные признаки составили шесть из десяти лучших:  `km_per_hour`,  `percent_sessions_in_last_month`,  `total_sessions_per_day`,  `percent_of_drives_to_favorite`,  `km_per_driving_day`, `km_per_drive`.
2. Модель XGBoost лучше подходит для данных, чем модель случайного леса.
3. Комбинации моделей на основе деревьев в этом этапе проекта ценны, поскольку они достигают более высоких оценок по всем метрикам оценки и требуют меньше предварительной обработки данных по сравнению с отдельной моделью логистической регрессии.
